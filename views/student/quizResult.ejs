<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results || <%=quizAssignment.title%></title>

    <link rel="stylesheet" href="/css/iziToast.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/cards.css">
    <link rel="shortcut icon" href="//www.ibm.com/favicon.ico" type="image/vnd.microsoft.icon">
</head>

<style>
    .dot {
        height: 12px;
        width: 12px;
        background-color: #ec8000;
        border-radius: 50%;
        display: inline-block;
    }

    .box {
        position: relative;
        margin-bottom: 30px;
        width: 100%;
        background-color: #ffffff;
        border-radius: 10px;
        padding: 0px;
        -webkit-transition: .5s;
        transition: .5s;
        display: -ms-flexbox;
        display: flex;
        -ms-flex-direction: column;
        flex-direction: column;
        -webkit-box-shadow: 0 0 30px 0 rgba(82, 63, 105, 0.05);
        box-shadow: 0 0 30px 0 rgba(82, 63, 105, 0.05);
    }

    .pull-up {
        -webkit-transition: all .25s ease;
        -o-transition: all .25s ease;
        -moz-transition: all .25s ease;
        transition: all .25s ease;
    }

    .pull-up:hover {
        -webkit-transform: translateY(-4px) scale(1.02);
        -moz-transform: translateY(-4px) scale(1.02);
        -ms-transform: translateY(-4px) scale(1.02);
        -o-transform: translateY(-4px) scale(1.02);
        transform: translateY(-4px) scale(1.02);
        -webkit-box-shadow: 0 14px 24px rgba(0, 0, 0, 0.2);
        box-shadow: 0 14px 24px rgba(0, 0, 0, 0.2);
        z-index: 999;
    }

    .box-body {
        padding: 1.5rem 1.5rem;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        border-radius: 10px;
    }

    .box-body>*:last-child {
        margin-bottom: 0;
    }
</style>

<body>

    <%-include('../partials/config')%>

    <div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header">
        <!-- header/ navbar area -->
        <%-include('../partials/header.ejs')%>
        <!-- header/navbar area end -->

        <div class="app-main">
            <!-- side bar area -->
            <%-include('../partials/sidebar.ejs')%>
            <!-- sidebar area end -->
            <div class="app-main__outer">
                <div class="app-main__inner">
                    <div class="app-main__inner">
                        <div class="container">
                            <div class="col-xl-12 col-md-12 col-lg-12 col-12">
                                <div style="background-color: #e1eaf9 !important;" class="box pull-up">
                                    <div class="box-body p-xl-0">
                                        <div class="row align-items-center">
                                            <div class="col-12 col-lg-3"><img
                                                    src="https://www.multipurposethemes.com/admin/eduadmin-template/images/svg-icon/color-svg/custom-14.svg"
                                                    alt=""></div>
                                            <div class="col-12 col-lg-9">
                                                <h2>Hello <span class="text-danger"> <%= User.firstName %>
                                                        <%= User.lastName %> </span> !</h2>
                                                <p class="text-dark mb-0 font-size-16">
                                                    Check out your performence in this quiz you can also see question
                                                    review
                                                    by clicking on <span class="text-primary"><strong> Show Question
                                                            Review
                                                        </strong> </span> button
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br><br><br>
                        <div class="container">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="card h-75">
                                        <div class="card-body">
                                            <div id='percentage'></div>
                                        </div>
                                        <div class="card-footer">
                                            <p class="d-flex align-items-center" style="font-weight: 600;"><span
                                                    class="dot mr-2"></span>
                                                Percentage</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="text-center align-items-center">
                                                <h3 class="text-primary">
                                                    <%=quiz.name%>
                                                </h3>
                                                <hr>
                                                <p class="text-dark">Quiz duration : <span
                                                        class="text-muted"><%=quiz.duration%>
                                                        min</span></p>
                                                <p class="text-dark">started on : <span
                                                        class="text-muted"><%= quizAssignmentResponse.start ? formatDateMoment(quizAssignmentResponse.start): 'not available'%></span>
                                                </p>
                                                <p class="text-dark">ended on : <span
                                                        class="text-muted"><%= quizAssignmentResponse.end ? formatDateMoment(quizAssignmentResponse.start): 'not available'%></span>
                                                </p>
                                                <p class="text-dark">Time taken: <span
                                                        class="text-muted"><%=quizAssignmentResponse.duration ? quizAssignmentResponse.duration +' '+ 'Minute' : 'not available' %>
                                                    </span>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="d-flex card-footer justify-content-between">
                                            <a class="btn btn-link" href="/student/quiz">back</a>
                                            <a type="button"
                                                href="/student/quiz/questionsReview/<%=quizAssignmentResponse._id%>"
                                                class="waves-effect waves-light btn btn-primary">Show
                                                Question Reviews <i class="fa fa-arrow-right ml-2"></i></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card h-75">
                                        <div class="card-body">
                                            <p class="text-muted">Total Questions <span
                                                    class="text-dark"><%=quizAssignmentResponse.totalQuestions%></span>
                                            </p>
                                            <div class="mt-4" id='rightWrongUnattempted'></div>
                                        </div>
                                        <div class=" mt-1 card-footer">
                                            <p class="d-flex align-items-center" style="font-weight: 600;"><span
                                                    class="dot mr-2"></span>Correct
                                                Questions</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script src="/js/main.js"></script>
    <script src="/js/jquery.min.js"></script>
    <script src="/js/iziToast.min.js"></script>
    <script src="/js/flashMessage.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <%
        const percentage = Math.round((quizAssignmentResponse.correctQuestions / quizAssignmentResponse.totalQuestions) * 100)
    %>
    <script>
        var optionsProgress = {
            chart: {
                height: 230,
                type: "radialBar"
            },

            series: [<%=percentage %>],
            colors: ['#0052cc'],
            plotOptions: {
                radialBar: {
                    hollow: {
                        margin: 15,
                        size: "70%"
                    },
                    track: {
                        background: '#ff9920',
                    },

                    dataLabels: {
                        showOn: "always",
                        name: {
                            offsetY: -10,
                            show: false,
                            color: "#888",
                            fontSize: "13px"
                        },
                        value: {
                            color: "#111",
                            fontSize: "30px",
                            show: true
                        }
                    }
                }
            },

            stroke: {
                lineCap: "round",
            },
            labels: ["Progress"]
        };


        var chart = new ApexCharts(document.querySelector("#percentage"), optionsProgress);

        chart.render();

        var options = {
            series: [<%=quizAssignmentResponse.inCorrectQuestions %>, <%=quizAssignmentResponse.correctQuestions %>, <%=quizAssignmentResponse.totalQuestions - quizAssignmentResponse.questionsAttempted %>],
            labels: ['InCorrect', 'Correct', 'Un-Attempted'],
            chart: {
                width: 328,
                type: 'donut',
            },
            dataLabels: {
                enabled: false
            },
            responsive: [{
                breakpoint: 480,
                options: {
                    chart: {
                        width: 200
                    },
                    legend: {
                        show: false
                    }
                }
            }],
            colors: ['#04a08b', '#ec8000', '#8e9596'],
            legend: {
                position: 'right',
                height: 230,
            }
        };

        var chart = new ApexCharts(document.querySelector("#rightWrongUnattempted"), options);
        chart.render();
    </script>

</body>

</html>